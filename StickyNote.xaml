<Window x:Class="TimeTask.StickyNote"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
        xmlns:local="clr-namespace:TimeTask"
        mc:Ignorable="d"
        x:Name="StickyNoteWindow"
        Title="Sticky Note" 
        Width="300" 
        Height="300"
        MinWidth="200"
        MinHeight="150"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        ShowInTaskbar="False"
        ResizeMode="CanResizeWithGrip"
        SizeToContent="Manual"
        WindowStartupLocation="Manual">
    <Window.Resources>
        <ResourceDictionary>
            <!-- Colors -->
            <SolidColorBrush x:Key="NoteHeaderBrush" Color="#FFD4A017"/>
            <SolidColorBrush x:Key="NoteBackgroundBrush" Color="#FFFFFF"/>
            
            <!-- Drop Shadow Effect -->
            <DropShadowEffect x:Key="DropShadowEffect" 
                            BlurRadius="10" 
                            ShadowDepth="2" 
                            Opacity="0.3"/>
            
            <!-- Window Button Style -->
            <Style x:Key="WindowButtonStyle" TargetType="Button">
                <Setter Property="Background" Value="Transparent"/>
                <Setter Property="Foreground" Value="White"/>
                <Setter Property="BorderThickness" Value="0"/>
                <Setter Property="Width" Value="30"/>
                <Setter Property="Height" Value="30"/>
                <Setter Property="Margin" Value="2"/>
                <Setter Property="Cursor" Value="Hand"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="Button">
                            <Border Background="{TemplateBinding Background}" 
                                    BorderThickness="0">
                                <ContentPresenter HorizontalAlignment="Center" 
                                                  VerticalAlignment="Center"/>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Background" Value="#40FFFFFF"/>
                                </Trigger>
                                <Trigger Property="IsPressed" Value="True">
                                    <Setter Property="Background" Value="#60FFFFFF"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
            
            <!-- Sticky Note Style -->
            <Style TargetType="local:StickyNote">
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="local:StickyNote">
                            <Border Background="{TemplateBinding Background}" 
                                    BorderThickness="1" 
                                    BorderBrush="#CCCCCC" 
                                    CornerRadius="4"
                                    Effect="{StaticResource DropShadowEffect}">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>
                                    
                                    <!-- Header -->
                                    <Border Grid.Row="0"
                                            Background="{StaticResource NoteHeaderBrush}"
                                            CornerRadius="4,4,0,0"
                                            MouseLeftButtonDown="Header_MouseLeftButtonDown">
                                        <Grid>
                                            <TextBlock Text="{TemplateBinding Title}" 
                                                       Margin="10,5"
                                                       VerticalAlignment="Center"
                                                       Foreground="White"
                                                       FontWeight="SemiBold"/>
                                            <StackPanel Orientation="Horizontal" 
                                                        HorizontalAlignment="Right"
                                                        VerticalAlignment="Center"
                                                        Margin="0,0,5,0">
                                                <Button x:Name="MinimizeButton"
                                                        Style="{StaticResource WindowButtonStyle}"
                                                        Content="_"
                                                        Click="MinimizeButton_Click"/>
                                                <Button x:Name="CloseButton"
                                                        Style="{StaticResource WindowButtonStyle}"
                                                        Content="×"
                                                        Click="CloseButton_Click"/>
                                            </StackPanel>
                                        </Grid>
                                    </Border>
                                    
                                    <!-- Content -->
                                    <ContentControl x:Name="ContentHost"
                                                  Grid.Row="1"
                                                  Content="{TemplateBinding Content}"
                                                  Margin="5"/>
                                    
                                    <!-- Resize Grip -->
                                    <ResizeGrip x:Name="WindowResizeGrip"
                                              Grid.Row="1"
                                              HorizontalAlignment="Right"
                                              VerticalAlignment="Bottom"
                                              Width="20"
                                              Height="20"/>
                                </Grid>
                            </Border>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
        </ResourceDictionary>
    </Window.Resources>
    
    <Border x:Name="MainBorder"
            Background="{StaticResource NoteBackgroundBrush}" 
            BorderThickness="1" 
            BorderBrush="{StaticResource NoteHeaderBrush}" 
            CornerRadius="4"
            Effect="{StaticResource DropShadowEffect}">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>
            
            <!-- Header -->
            <Border x:Name="HeaderBorder"
                    Grid.Row="0"
                    Background="{StaticResource NoteHeaderBrush}"
                    CornerRadius="4,4,0,0"
                    MouseLeftButtonDown="Header_MouseLeftButtonDown">
                <Grid>
                    <TextBlock x:Name="TitleText"
                               Text="{Binding Title, RelativeSource={RelativeSource AncestorType=Window}}" 
                               Margin="10,5"
                               VerticalAlignment="Center"
                               Foreground="White"
                               FontWeight="SemiBold"
                               TextTrimming="CharacterEllipsis"/>
                    <StackPanel Orientation="Horizontal" 
                                HorizontalAlignment="Right"
                                VerticalAlignment="Center"
                                Margin="0,0,5,0">
                        <Button x:Name="MinimizeButton"
                                Style="{StaticResource WindowButtonStyle}"
                                Content="_"
                                ToolTip="Minimize"
                                Click="MinimizeButton_Click"/>
                        <Button x:Name="CloseButton"
                                Style="{StaticResource WindowButtonStyle}"
                                Content="×"
                                ToolTip="Close"
                                Click="CloseButton_Click"/>
                    </StackPanel>
                </Grid>
            </Border>
            
            <!-- Content Area -->
            <Border Grid.Row="1"
                    Background="{StaticResource NoteBackgroundBrush}"
                    CornerRadius="0,0,4,4">
                <ContentPresenter x:Name="ContentHost"
                                Content="{Binding NoteContent, RelativeSource={RelativeSource AncestorType=local:StickyNote}}"
                                Margin="5"/>
            </Border>
            
            <!-- Resize Grip -->
            <ResizeGrip x:Name="WindowResizeGrip"
                        Grid.Row="1"
                        HorizontalAlignment="Right"
                        VerticalAlignment="Bottom"
                        Width="20"
                        Height="20"
                        IsTabStop="False"/>
        </Grid>
    </Border>
</Window>
